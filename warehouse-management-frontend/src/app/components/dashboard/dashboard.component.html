<!-- Main Dashboard Content -->
<div class="content">
  <h2>Warehouse Dashboard</h2>

  <!-- Dropdown list -->
  <select (change)="onSelect($event)" class="form-select mb-3" aria-label="Select Warehouse">
    <option *ngFor="let warehouse of warehouses" [value]="warehouse.name">
      {{ warehouse.name }}
    </option>
  </select>

  <!-- KPI Cards -->
  <div class="row mb-4 mt-3">
    <div class="col-md-3">
      <div class="dashboard-card">
        <h5>Location</h5>
        <p class="fw-bold">{{ warehouseLocation }}</p>
      </div>
    </div>
    <div class="col-md-3">
      <div class="dashboard-card">
        <h5>Capacity</h5>
        <p class="fw-bold">{{ totalQuantity }} / {{ warehouseCapacity }}</p>
      </div>
    </div>
    <div class="col-md-3">
      <div class="dashboard-card">
        <h5>Open Alerts</h5>
        <p class="fw-bold text-danger">{{ openAlertCount }}</p>
      </div>
    </div>
    <div class="col-md-3">
      <div class="dashboard-card">
        <h5>Recent Movements</h5>
        <p class="fw-bold">{{ recentMovementCount }}</p>
      </div>
    </div>
  </div>

  <!-- Quick Actions -->
  <h4>Quick Actions</h4>
  <div class="row mb-3 " id="quickActions">
    <div class="col-md-2">
      <button class="btn btn-primary w-100" [routerLink]="['/inventory']"> üì¶ Manage Inventory</button>
    </div>
    <div class="col-md-2">
      <button class="btn btn-secondary w-100"> üìã View Logs</button>
    </div>
    <div class="col-md-2">
      <a class="btn btn-danger w-100" [routerLink]="['/alerts']">‚ö†Ô∏è Create Alert</a>
    </div>
    <div class="col-md-2">
      <button class="btn btn-info w-100" [routerLink]="['/users']">üë§ Assign Users</button>
    </div>
  </div>

  <!-- Alerts Section -->
  <h4>Alerts</h4>
  <div class="dashboard-card mb-4">
    <ul class="list-group">
      <ng-container *ngFor="let alert of alerts">
        <li *ngIf="alert.warehouse.name === selectedWarehouse" class="list-group-item d-flex justify-content-between">
          <ul>
            <li></li>
            <li>
              <span [ngClass]="{
                  'text-danger': alert.status === 'NEW',
                  'text-success': alert.status === 'CLOSED',
                  'text-primary': alert.status === 'ACTIVE'
                }">
                {{ alert.status }}
              </span>
              {{ alert.message }}
            </li>
          </ul>
        </li>
      </ng-container>
    </ul>
  </div>

  <!-- Inventory List -->
  <h4>Inventory in {{ selectedWarehouse }}</h4>
  <div class="dashboard-card mb-4">
    <div class="d-flex justify-content-end mb-2">
      <button class="btn p-0 border-0 bg-transparent" (click)="onAddInventory()" title="Add Inventory Item"
        style="line-height: 1;">
        <svg width="32" height="32" viewBox="0 0 32 32" fill="none" aria-hidden="true">
          <circle cx="16" cy="16" r="15" stroke="#888" stroke-width="2" fill="none" />
          <line x1="16" y1="8" x2="16" y2="24" stroke="#888" stroke-width="3" stroke-linecap="round" />
          <line x1="8" y1="16" x2="24" y2="16" stroke="#888" stroke-width="3" stroke-linecap="round" />
        </svg>
      </button>
    </div>
    <table class="table table-sm table-bordered table-striped">
      <thead>
        <tr>
          <th>SKU</th>
          <th>Name</th>
          <th>Quantity</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let item of inventoryItems">
          <td>{{ item.itemSku }}</td>
          <td>{{ item.itemName }}</td>
          <td>{{ item.quantity }}</td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Inventory Movements -->
  <h4>Recent Inventory Movements</h4>
  <div class="dashboard-card mb-4">
    <table class="table table-sm table-striped table-bordered">
      <thead>
        <tr>
          <th>#</th>
          <th>Item</th>
          <th>From</th>
          <th>To</th>
          <th>Quantity</th>
          <th>Type</th>
          <th>By</th>
          <th>Time</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let movement of recentMovements; let i = index">
          <td>{{ i + 1 }}</td>
          <td>{{ movement.itemName || 'N/A' }}</td>
          <td>{{ movement.fromWarehouseName || 'N/A' }}</td>
          <td>{{ movement.toWarehouseName || 'N/A' }}</td>
          <td>{{ movement.quantity }}</td>
          <td>{{ movement.movementType }}</td>
          <td>{{ movement.userName || 'N/A' }}</td>
          <td>{{ movement.time | date:'short' }}</td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Section Heading OUTSIDE the card -->
  <h4>Storage Locations in {{ selectedWarehouse }}</h4>
  <div class="dashboard-card mb-4">
    <div class="d-flex justify-content-end mb-2">
      <button class="btn p-0 border-0 bg-transparent" (click)="addStorageLocation()" title="Add Storage Location"
        style="line-height: 1;">
        <svg width="32" height="32" viewBox="0 0 32 32" fill="none" aria-hidden="true">
          <circle cx="16" cy="16" r="15" stroke="#888" stroke-width="2" fill="none" />
          <line x1="16" y1="8" x2="16" y2="24" stroke="#888" stroke-width="3" stroke-linecap="round" />
          <line x1="8" y1="16" x2="24" y2="16" stroke="#888" stroke-width="3" stroke-linecap="round" />
        </svg>
      </button>
    </div>
    <table class="table table-sm table-bordered table-striped">
      <thead>
        <tr>
          <th>Name</th>
          <th>Max Capacity</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let location of storageLocations">
          <td>{{ location.name }}</td>
          <td>{{ location.currentCapacity }}/{{ location.maxCapacity }}</td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Personnel Assigned -->
  <h4>Personnel Assigned to {{ selectedWarehouse }}</h4>
  <div class="dashboard-card">
    <div class="d-flex justify-content-end mb-2">
      <button class="btn p-0 border-0 bg-transparent" (click)="onAddUser()" title="Add User" style="line-height: 1;">
        <svg width="32" height="32" viewBox="0 0 32 32" fill="none" aria-hidden="true">
          <circle cx="16" cy="16" r="15" stroke="#888" stroke-width="2" fill="none" />
          <line x1="16" y1="8" x2="16" y2="24" stroke="#888" stroke-width="3" stroke-linecap="round" />
          <line x1="8" y1="16" x2="24" y2="16" stroke="#888" stroke-width="3" stroke-linecap="round" />
        </svg>
      </button>
    </div>
    <table class="table table-sm table-bordered table-striped">
      <thead>
        <tr>
          <th>Username</th>
          <th>Status</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let p of personnel">
          <td>{{ p.username }}</td>
          <td>{{ p.status }}</td>
        </tr>
      </tbody>
    </table>
  </div>
</div>