<div class="content">
    <h1>ALERTS</h1>

    <!-- Add Alert Form -->
    <form (ngSubmit)="addAlert()" #alertForm="ngForm" style="margin-bottom:2rem;">
        <label>
            Message:
            <input type="text" [(ngModel)]="newAlert.message" name="message" required />
        </label>
        <label>
            Status:
            <select [(ngModel)]="newAlert.status" name="status" required>
                <option value="NEW">New</option>
                <option value="ACTIVE">Active</option>
                <option value="CLOSED">Closed</option>
            </select>
        </label>
        <label>
            Warehouse:
            <select #warehouseSelect [(ngModel)]="newAlert.warehouseId" name="warehouseId" required
                (change)="onNewAlertWarehouseChange(warehouseSelect.value)">
                <option *ngFor="let warehouse of warehouses" [value]="warehouse.id">{{ warehouse.name }}</option>
            </select>
        </label>
        <label>
            Assigned User:
            <select [(ngModel)]="newAlert.assignedUserId" name="assignedUserId">
                <option value="">Unassigned</option>
                <option *ngFor="let user of safePersonnelForSelectedWarehouse" [value]="user.id">
                    {{ user.username }}
                </option>

            </select>
        </label>
        <button type="submit" [disabled]="!alertForm.form.valid">Add Alert</button>
    </form>

    <!-- Dropdown list -->
    <select (change)="onSelect($event)">
        <option *ngFor="let warehouse of warehouses" [value]="warehouse.name">{{warehouse.name}}</option>
    </select>


    <div class="alert-cards">
        <div class="alert-card" *ngFor="let alert of alerts">
            <h3>{{ alert.message }}</h3>
            <div class="alert-details">
                <div>
                    <label><strong>Status:</strong></label>
                    <span> {{ alert.status }}</span>
                </div>
                <div>
                    <label><strong>Assigned User:</strong></label>
                    <span>{{ getAssignedUserName(alert) }}</span>
                </div>
                <div>
                    <label><strong>Warehouse:</strong></label>
                    <span> {{ alert.warehouse?.name || 'N/A' }}</span>
                </div>
                <div>
                    <label><strong>Time:</strong></label>
                    <span> {{ alert.formatTime() }}</span>
                </div>
            </div>
            <div class="alert-actions">
                <button (click)="openEditModal(alert)">Edit</button>
                <button (click)="deleteAlert(alert.id)">Delete</button>
            </div>
        </div>
    </div>
</div>